(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){e.exports=a(66)},29:function(e,t,a){},34:function(e,t,a){},55:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(21),s=a.n(i),c=(a(29),a(1)),r=a(3),o=a(5),m=a(4),u=a(6),d=(a(34),a(12)),v=a(22),p=function(e){var t=e.closePreview,a=e.filename,n=e.objectUrl;return l.a.createElement("div",{className:"preview-toolbar no-print"},l.a.createElement("div",{className:"columns"},l.a.createElement("div",{className:"column is-12",style:{paddingBottom:0}},l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"},l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{className:"button is-dark is-outlined",onClick:t},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-arrow-left"})),l.a.createElement("span",null,"Retour"))),l.a.createElement("div",{className:"level-item"},l.a.createElement("a",{href:n,download:a,className:"button is-link is-outlined ".concat(a?"":"is-loading")},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-file-pdf"})),l.a.createElement("span",null,"T\xe9lecharger"))))))),l.a.createElement("hr",null))},h=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).embedPdf=function(){var e=a.props.invoice;v.post("/api/html2pdf",{data:e},{headers:{"Content-Type":"application/json",Accept:"application/pdf"},responseType:"blob"}).then(function(t){var n="".concat(e.type,"-").concat(e.meta.number,".pdf"),l=new Blob([t.data],{type:"application/pdf"}),i=window.URL.createObjectURL(l);a.setState({filename:n,objectUrl:i})}).catch(function(e){console.log(e)})},a.state={filename:null,objectUrl:null},a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.scrollTo(0,0),this.state.filename||this.embedPdf()}},{key:"render",value:function(){return l.a.createElement("div",{className:"container"},l.a.createElement(p,{closePreview:this.props.closePreview,filename:this.state.filename,objectUrl:this.state.objectUrl}),l.a.createElement("div",{className:"columns is-multiline"},this.state.filename&&l.a.createElement("object",{id:"mediaObject",data:this.state.objectUrl,type:"application/pdf",name:this.state.filename},"alt: ",l.a.createElement("a",{href:this.state.objectUrl,download:this.state.filename},this.state.filename))))}}]),t}(n.Component),f=a(7),E=a(10),b=(a(55),function(e){var t=e.name,a=e.id,n=e.value,i=e.changeHandler,s=Object(E.a)(e,["name","id","value","changeHandler"]);return l.a.createElement("div",{className:"control"},l.a.createElement("input",Object.assign({id:a,name:t,type:"text",className:"input",onChange:i||function(e){},value:n},s)))}),N=function(e){var t=e.name,a=e.id,n=e.value,i=e.changeHandler,s=Object(E.a)(e,["name","id","value","changeHandler"]);return l.a.createElement("div",{className:"control"},l.a.createElement("textarea",Object.assign({className:"textarea",name:t,id:a,onChange:i||function(e){},value:n},s)))},y=function(e){var t=e.name,a=e.value,n=e.changeHandler,i=e.tabs,s=Object(E.a)(e,["name","value","changeHandler","tabs"]);return l.a.createElement("div",{className:"select is-fullwidth"},l.a.createElement("select",Object.assign({name:t,value:a,onChange:n},s),i.map(function(e,t){return l.a.createElement("option",{key:"options-".concat(t),value:e.value},e.label)})))},g=function(e){var t=e.target,a=e.label,n=e.icon;return l.a.createElement("label",{htmlFor:t,className:"label"},l.a.createElement("span",{className:"icon is-small has-text-info"},l.a.createElement("i",{className:"fas fa-".concat(n)})),l.a.createElement("span",null," ".concat(a)))},w=function(e){var t=e.name,a=e.label;return l.a.createElement("div",{className:"file has-name is-fullwidth"},l.a.createElement("label",{className:"file-label"},l.a.createElement("input",{className:"file-input",type:"file",name:t}),l.a.createElement("span",{className:"file-cta"},l.a.createElement("span",{className:"file-icon"},l.a.createElement("i",{className:"fas fa-upload"})),l.a.createElement("span",{className:"file-label"},a)),l.a.createElement("span",{className:"file-name"})))},T=function(e){var t=e.options,a=e.optionsChangeHandler,n=e.types,i=e.type,s=e.typeChangeHandler;return l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"},l.a.createElement("div",{className:"level-item"},l.a.createElement("div",{className:"field is-horizontal"},l.a.createElement("div",{className:"field-label is-normal"},l.a.createElement("label",{className:"label"},"Formulaire")),l.a.createElement("div",{className:"field-body"},l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(y,{name:"input-type",value:i,changeHandler:s,tabs:n.map(function(e){return{value:e,label:e}})}))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(y,{name:"input-detailed",value:t.detailed,changeHandler:a,tabs:[{value:"false",label:"Simple"},{value:"true",label:"D\xe9taill\xe9"}]}))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(y,{name:"input-withTaxes",value:t.withTaxes,changeHandler:a,tabs:[{value:"false",label:"Sans Taxes"},{value:"true",label:"Avec Taxes"}]}))))))),l.a.createElement("div",{className:"level-right"}))},x=function(e){var t=e.from,a=e.to,n=e.number,i=e.date,s=e.changeHandler,c=e.type;return l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"field"},l.a.createElement(g,{target:"input-from",label:"De",icon:"home"}),l.a.createElement(N,{name:"input-from",id:"input-from",changeHandler:s,value:t}))),l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"field"},l.a.createElement(g,{target:"",label:"Logo",icon:"image"}),l.a.createElement(w,{name:"file-input",label:"Ajouter une image"}))),l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"field"},l.a.createElement(g,{target:"input-to",label:"Factur\xe9 \xe0",icon:"handshake"}),l.a.createElement(N,{name:"input-to",id:"input-to",changeHandler:s,value:a}))),l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"field"},l.a.createElement(g,{target:"input-number",label:"".concat(c," n\xb0"),icon:"search"}),l.a.createElement(b,{name:"input-number",id:"input-number",changeHandler:s,value:n}))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"field"},l.a.createElement(g,{target:"input-date",label:"Date",icon:"calendar-day"}),l.a.createElement(b,{name:"input-date",id:"input-date",changeHandler:s,value:i}))))))},I=function(e){var t=e.detailed,a=e.withTaxes,n=[{detailedOnly:!0,withTaxesOnly:!1,label:"Qt\xe9",icon:"sort-amount-up",size:1},{detailedOnly:!1,withTaxesOnly:!1,label:"D\xe9signation",icon:"tag",size:t?4:6},{detailedOnly:!1,withTaxesOnly:!1,label:"Prix".concat(t?" Unit.":"").concat(a?" HT":""),icon:"euro-sign",size:2},{detailedOnly:!0,withTaxesOnly:!1,label:"Montant".concat(a?" HT":""),icon:"euro-sign",size:2},{detailedOnly:!1,withTaxesOnly:!0,label:"TVA",icon:"percentage",size:t?2:3}].filter(function(e){return(!e.detailedOnly||e.detailedOnly&&t)&&(!e.withTaxesOnly||e.withTaxesOnly&&a)});return l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"columns"},n.map(function(e,t){return l.a.createElement("div",{className:"column is-".concat(e.size),key:"item-heading-".concat(t)},l.a.createElement(g,{icon:e.icon,label:e.label}))})))},O=function(e){var t=e.detailed,a=e.withTax,n=e.data,i=e.changeHandler,s=e.blurHandler;return l.a.createElement("div",{className:"column is-12 animated fadeIn fast"},l.a.createElement("div",{className:"columns"},t&&l.a.createElement("div",{className:"column is-1"},l.a.createElement(b,{"data-id":"".concat(n.id),"data-field":"quantity",value:n.quantity,changeHandler:function(e){i(e,"update")},onBlur:s})),l.a.createElement("div",{className:"column is-".concat(t?"4":"6")},l.a.createElement(N,{"data-id":"".concat(n.id),"data-field":"title",value:n.title,changeHandler:function(e){i(e,"update")},onBlur:s})),l.a.createElement("div",{className:"column is-2"},l.a.createElement(b,{"data-id":"".concat(n.id),"data-field":"price",value:n.price,changeHandler:function(e){i(e,"update")},onBlur:s})),t&&l.a.createElement("div",{className:"column is-2"},l.a.createElement(b,{disabled:!0,value:(n.quantity*n.price).toFixed(2),changeHandler:function(e){}})),a&&l.a.createElement("div",{className:"column is-2"},l.a.createElement(b,{"data-id":"".concat(n.id),"data-field":"tax",value:n.tax,changeHandler:function(e){i(e,"update")},onBlur:s})),l.a.createElement("div",{className:"column is-1"},l.a.createElement("button",{"data-id":"".concat(n.id),onClick:function(e){return i(e,"remove")},className:"button is-danger is-fullwidth"},l.a.createElement("span",{"data-id":"".concat(n.id),className:"icon"},l.a.createElement("i",{"data-id":"".concat(n.id),className:"fas fa-times"}))))))},j=function(e){var t=e.detailed,a=e.withTaxes,n=e.changeHandler,i=e.blurHandler,s=e.items;return l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement(I,{detailed:t,withTaxes:a}),s.map(function(e){return l.a.createElement(O,{key:e.id,data:e,changeHandler:n,detailed:t,withTax:a,blurHandler:i})}),l.a.createElement("div",{className:"column is-12"},l.a.createElement("button",{onClick:function(e){return n(e,"add")},className:"button is-link is-fullwidth"},l.a.createElement("span",{className:"icon"},l.a.createElement("i",{className:"fas fa-plus"})),l.a.createElement("span",null,"Ajouter un article"))))},k=a(23),H=a(9),C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.id=t.id||H.generate(),this.type=t.type||"Facture",this.types=["Facture","Devis"],this.items=t.items?Object(k.a)(t.items):[],this.meta=t.meta?Object(f.a)({},t.meta):{date:(new Date).toLocaleDateString(),from:"",to:"",number:"",terms:""},this.options=t.options?Object(f.a)({},t.options):{detailed:!1,withTaxes:!1}}return Object(r.a)(e,null,[{key:"getSubTotals",value:function(e){var t=+e.quantity*+e.price,a=t*(+e.tax/100);return{subTotalTaxExcluded:t,subTotalTaxIncluded:t+a,subTotalTax:a}}},{key:"getTotals",value:function(t){var a=0,n=0,l=0;return t.length&&t.forEach(function(t){var i=e.getSubTotals(t);n+=i.subTotalTaxExcluded,a+=i.subTotalTaxIncluded,l+=i.subTotalTax}),{totalTaxExcluded:n,totalTaxIncluded:a,totalTaxes:l}}},{key:"firstLine",value:function(e){return e.split("\n")[0]}},{key:"afterFirstLine",value:function(e){return e.split("\n").slice(1).join("\n")}}]),e}(),S=function(e){var t=e.label,a=e.value,n=e.size,i=e.color;return l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"columns has-text-".concat(i)},l.a.createElement("div",{className:"column is-4"}),l.a.createElement("div",{className:"column is-4 has-text-right"},l.a.createElement("span",{className:"is-size-".concat(n)},t)),l.a.createElement("div",{className:"column is-4 has-text-right"},l.a.createElement("span",{className:"is-size-".concat(n)},a," \u20ac"))))},F=function(e){var t=e.withTax,a=e.items,n=C.getTotals(a),i=n.totalTaxExcluded,s=n.totalTaxIncluded,c=n.totalTaxes;return l.a.createElement("div",{className:"columns is-multiline"},t&&l.a.createElement(S,{label:"TOTAL HT",value:i.toFixed(2),size:"5",color:"grey-dark"}),t&&l.a.createElement(S,{label:"TVA",value:c.toFixed(2),size:"6",color:"grey"}),l.a.createElement(S,{label:"TOTAL".concat(t?" TTC":""),value:s.toFixed(2),size:"4",color:"black-ter"}))},B=function(e){var t=e.terms,a=e.changeHandler;return l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"field"},l.a.createElement(g,{target:"input-terms",icon:"building",label:"Conditions et modalit\xe9s de paiement"}),l.a.createElement(N,{name:"input-terms",id:"input-terms",value:t,changeHandler:a}))))},P=function(e){var t=e.leaveInvoice,a=e.openPreview,n=e.removeInvoice;return l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"},l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{onClick:t,className:"button is-dark"},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-arrow-left"})),l.a.createElement("span",null,"Retour"))),l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{onClick:a,className:"button is-info"},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-eye"})),l.a.createElement("span",null,"Aper\xe7u")))),l.a.createElement("div",{className:"level-right"},l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{onClick:n,className:"button is-danger"},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-trash-alt"})),l.a.createElement("span",null,"Supprimer")))))},D=function(){return l.a.createElement("div",{className:"columns no-print"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("hr",null)))},U=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null,title:"",price:0,tax:0,quantity:1};Object(c.a)(this,e),this.id=t.id||H.generate(),this.title=t.title,this.price=t.price,this.tax=t.tax,this.quantity=t.quantity};function A(e){return JSON.parse(JSON.stringify(e))}function L(e){var t=0;return Object.keys(e).forEach(function(e){return t++}),!Boolean(t)}var z=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).metaChangeHandler=function(e){var t=Object(f.a)({},a.state.meta);t[e.target.name.split("-")[1]]=e.target.value,a.setState({meta:t})},a.optionsChangeHandler=function(e){var t=Object(f.a)({},a.state.options),n=e.target.name.split("-")[1],l="true"===e.target.value;t[n]=l;var i=a.cloneItems(a.state.items);i.forEach(function(e){e.quantity=t.detailed?e.quantity:1,e.tax=t.withTaxes?e.tax:0}),a.setState({options:t,items:i})},a.typeChangeHandler=function(e){var t=e.target.value;a.state.types.includes(t)&&a.setState({type:t})},a.itemsChangeHandler=function(e,t){switch(t){case"add":a.addItem();break;case"update":var n=e.target.getAttribute("data-id"),l=e.target.getAttribute("data-field"),i=e.target.value;a.updateItem(n,l,i);break;case"remove":var s=e.target.getAttribute("data-id");a.removeItem(s)}},a.itemsBlurHandler=function(e){var t=e.target.getAttribute("data-id"),n=e.target.getAttribute("data-field"),l=e.target.value;switch(n){case"title":l=l.trim();break;case"quantity":case"tax":case"price":l=isNaN(l)?0:+(+l).toFixed(2)}a.updateItem(t,n,l)},a.addItem=function(){var e=a.cloneItems(a.state.items);e.push(new U),a.setState({items:a.cloneItems(e)})},a.updateItem=function(e,t,n){var l=a.cloneItems(a.state.items);l.find(function(t){return t.id===e})[t]=n,a.setState({items:a.cloneItems(l)})},a.removeItem=function(e){var t=a.cloneItems(a.state.items);t=t.filter(function(t){return t.id!==e}),a.setState({items:a.cloneItems(t)})},a.cloneItems=function(e){return e.map(function(e){return new U(e)})},a.state={id:null,type:"Facture",types:["Facture","Devis"],meta:{from:"",to:"",number:"",date:"",terms:""},options:{detailed:!1,withTaxes:!1},items:[]},a.state=A(a.props.invoice),a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.invoice.id!==this.state.id&&this.setState(Object(f.a)({},A(e.invoice)))}},{key:"shouldComponentUpdate",value:function(e,t){return JSON.stringify(t)!==JSON.stringify(this.state)}},{key:"componentDidUpdate",value:function(e,t){this.props.updateHandler(A(this.state))}},{key:"render",value:function(){return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box animated slideInDown"},l.a.createElement(T,{type:this.state.type,types:this.state.types,options:this.state.options,optionsChangeHandler:this.optionsChangeHandler,typeChangeHandler:this.typeChangeHandler}))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box animated fadeIn"},l.a.createElement(x,{companyTitle:this.state.companyTitle,type:this.state.type,from:this.state.meta.from,to:this.state.meta.to,number:this.state.meta.number,date:this.state.meta.date,changeHandler:this.metaChangeHandler}),l.a.createElement(D,null),l.a.createElement(j,{detailed:this.state.options.detailed,withTaxes:this.state.options.withTaxes,changeHandler:this.itemsChangeHandler,blurHandler:this.itemsBlurHandler,items:this.state.items}),l.a.createElement(F,{withTax:this.state.options.withTaxes,items:this.state.items}),l.a.createElement(D,null),l.a.createElement(B,{terms:this.state.meta.terms,changeHandler:this.metaChangeHandler}))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box"},l.a.createElement(P,{leaveInvoice:this.props.leaveInvoice,openPreview:this.props.openPreview,removeInvoice:this.props.removeInvoice})))))}}]),t}(n.Component),q=function(e){var t=e.setNewInvoiceType,a=e.invoiceTypes,n=e.newInvoice,i=e.typeSelected;return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"}),l.a.createElement("div",{className:"level-right"},l.a.createElement("div",{className:"level-item"},l.a.createElement("div",{className:"field has-addons"},l.a.createElement("div",{className:"control"},l.a.createElement("button",{className:"button is-static"},"Nouveau")),l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(y,{onChange:t,defaultValue:"",name:"newInvoiceType",tabs:a.map(function(e){return{value:e,label:e}}).concat({value:"",label:"Document"})})),l.a.createElement("div",{className:"control"},l.a.createElement("button",Object.assign({},i?{}:{disabled:!0},{onClick:n,className:"button is-primary ".concat(i?" animated pulse fast":"")}),l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-plus"})))))))))),l.a.createElement(D,null))},M=a(13),Y=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).sort=function(e){var t=e.target.getAttribute("data-sortby");if(t&&a.possibleSorts.includes(t)){var n=null;n=a.state.sortBy===t&&"desc"===a.state.sortOrder?"asc":"desc";var l=A(a.state.invoices),i=Object.keys(l).map(function(e){return l[e]}),s={};i.sort(function(e,a){var l=0,i=0;switch(t){case"number":l=e.meta.number.replace(/\D/g,""),i=a.meta.number.replace(/\D/g,"");break;case"date":var s="MM-DD-YYYY";navigator.language.includes("fr")&&(s="DD-MM-YYYY"),l=M(e.meta.date,s).valueOf(),i=M(a.meta.date,s).valueOf();break;case"total":l=C.getTotals(e.items).totalTaxIncluded,i=C.getTotals(a.items).totalTaxIncluded}return"desc"===n?i-l:"asc"===n?l-i:0}),i.forEach(function(e){s[e.id]=e}),a.setState({sortBy:t,sortOrder:n,invoices:A(s)})}},a.setFilter=function(e){var t=e.target.value;a.setState({filterBy:t})},a.formatClientName=function(e){return e.slice(0,20)},a.state={invoices:A(a.props.invoices),sortBy:"number",sortOrder:"desc",filterBy:""},a.possibleSorts=["number","date","total"],a.filters=(new C).types,a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.state.invoices,a=this.state.sortBy,n=this.state.sortOrder,i=this.state.filterBy,s={cursor:"pointer",userSelect:"none"};return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box"},l.a.createElement("table",{className:"table is-striped is-hoverable is-fullwidth"},l.a.createElement("thead",{onClick:this.sort},l.a.createElement("tr",null,l.a.createElement("th",{className:"has-text-centered"},l.a.createElement("span",null,"Client")),l.a.createElement("th",{style:{paddingTop:"0"}},l.a.createElement("div",{className:"field has-addons"},l.a.createElement("div",{className:"control"},l.a.createElement("button",{className:"button is-static"},"Type")),l.a.createElement("div",{className:"control"},l.a.createElement(y,{value:this.state.filterBy,onChange:this.setFilter,tabs:this.filters.map(function(e){return{label:e,value:e}}).concat({value:"",label:"Tout"})})))),l.a.createElement("th",{"data-sortby":"number",style:s},l.a.createElement("span",{className:"number"===a?"has-text-link":"","data-sortby":"number"},"Nombre")," ",l.a.createElement("span",{"data-sortby":"number",className:"icon is-small has-text-info"},"number"===a&&l.a.createElement("i",{"data-sortby":"number",className:"fas fa-sort-numeric-".concat("desc"===n?"down":"up")}))),l.a.createElement("th",{"data-sortby":"date",style:s},l.a.createElement("span",{"data-sortby":"date",className:"date"===a?"has-text-link":""},"Date")," ",l.a.createElement("span",{"data-sortby":"date",className:"icon is-small has-text-info"},"date"===a&&l.a.createElement("i",{"data-sortby":"date",className:"fas fa-sort-numeric-".concat("desc"===n?"down":"up")}))),l.a.createElement("th",{"data-sortby":"total",style:s},l.a.createElement("span",{"data-sortby":"total",className:"total"===a?"has-text-link":""},"Montant")," ",l.a.createElement("span",{"data-sortby":"total",className:"icon is-small has-text-info"},"total"===a&&l.a.createElement("i",{"data-sortby":"total",className:"fas fa-sort-amount-".concat("desc"===n?"down":"up")}))))),l.a.createElement("tbody",null,Object.keys(t).map(function(a){var n=t[a];return l.a.createElement("tr",{className:Boolean(i)&&n.type!==i?"is-hidden":"",style:{cursor:"pointer"},onClick:e.props.selectInvoice,"data-id":a,key:a},l.a.createElement("td",{"data-id":a},e.formatClientName(C.firstLine(n.meta.to))),l.a.createElement("td",{"data-id":a,className:"has-text-centered"},n.type),l.a.createElement("td",{"data-id":a},n.meta.number),l.a.createElement("td",{"data-id":a},n.meta.date),l.a.createElement("td",{"data-id":a},C.getTotals(n.items).totalTaxIncluded.toFixed(2)," \u20ac"))})))))))}}]),t}(n.Component),W=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).updateInvoice=function(e){var t=e.id,n=A(a.state.invoices);n[t]=A(e),a.currentInvoiceWasUpdated=!0,a.setState({invoices:n,currentInvoice:A(e)})},a.newInvoice=function(){var e=new C;a.state.newInvoiceType&&(e.type=a.state.newInvoiceType);var t=function(e){var t={};return Object.keys(e).forEach(function(a){var n=e[a].type;n in t?t[n]++:t[n]=1}),t}(a.state.invoices)[e.type]||0;e.meta.number=t+1,a.setState({currentInvoice:e,showForm:!0})},a.setNewInvoiceType=function(e){var t=e.target.value;Boolean(t)&&a.invoiceTypes.includes(t)?a.setState({newInvoiceType:t}):a.setState({newInvoiceType:null})},a.selectInvoice=function(e){var t=e.target.getAttribute("data-id"),n=a.state.invoices[t];n&&a.setState({currentInvoice:A(n),showForm:!0})},a.removeInvoice=function(){var e=a.state.currentInvoice.id,t=A(a.state.invoices);delete t[e],a.setState({invoices:t,currentInvoice:null,newInvoiceType:null,showForm:!1},function(){a.updateLocalForage()})},a.leaveInvoice=function(){a.saveChanges(),a.setState({currentInvoice:null,newInvoiceType:null,showForm:!1})},a.openPreview=function(){a.saveChanges(),a.setState({showPreview:!0})},a.hidePreview=function(){a.setState({showPreview:!1})},a.updateLocalForage=function(){d.setItem("invoices",A(a.state.invoices)).then(function(e){console.log("LocalForage Updated")}).catch(function(e){console.log("Unable to update localForage\n"),console.error(e)})},a.loadFromLocalForage=function(){return d.getItem("invoices")},a.saveChanges=function(){if(a.currentInvoiceWasUpdated){var e=A(a.state.currentInvoice);console.log(e),a.updateLocalForage(),a.currentInvoiceWasUpdated=!1}},a.state={showPreview:!1,showForm:!1,currentInvoice:null,invoices:{},newInvoiceType:null},a.currentInvoiceWasUpdated=!1,a.invoiceTypes=(new C).types,a}return Object(u.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;L(this.state.invoices)&&this.loadFromLocalForage().then(function(t){t&&"object"===typeof t&&!L(t)&&e.setState({invoices:A(t)})}).catch(function(e){console.error(e)})}},{key:"render",value:function(){return l.a.createElement("section",null,this.state.showPreview&&l.a.createElement(h,{closePreview:this.hidePreview,invoice:this.state.currentInvoice}),!this.state.showPreview&&l.a.createElement("div",{id:"main"},!this.state.showForm&&l.a.createElement(q,{typeSelected:Boolean(this.state.newInvoiceType),invoiceTypes:this.invoiceTypes,setNewInvoiceType:this.setNewInvoiceType,newInvoice:this.newInvoice}),!L(this.state.invoices)&&!this.state.showForm&&l.a.createElement(Y,{invoices:this.state.invoices,selectInvoice:this.selectInvoice}),this.state.showForm&&l.a.createElement(z,{key:this.state.currentInvoice.id,updateHandler:this.updateInvoice,invoice:this.state.currentInvoice,leaveInvoice:this.leaveInvoice,openPreview:this.openPreview,removeInvoice:this.removeInvoice})))}}]),t}(n.Component),J=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"section"},l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement(W,null)))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[24,2,1]]]);
//# sourceMappingURL=main.e6b9b8ea.chunk.js.map