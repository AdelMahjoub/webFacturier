(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){e.exports=a(66)},29:function(e,t,a){},34:function(e,t,a){},64:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),s=a(22),i=a.n(s),c=(a(29),a(1)),r=a(3),o=a(5),m=a(4),d=a(6),u=(a(34),a(14)),v=a(23),h=function(e){var t=e.closePreview,a=e.filename,n=e.objectUrl;return l.a.createElement("div",{className:"preview-toolbar no-print"},l.a.createElement("div",{className:"columns"},l.a.createElement("div",{className:"column is-12",style:{paddingBottom:0}},l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"},l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{className:"button is-dark is-outlined",onClick:t},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-arrow-left"})),l.a.createElement("span",null,"Retour"))),l.a.createElement("div",{className:"level-item"},l.a.createElement("a",{href:n,download:a,className:"button is-link is-outlined ".concat(a?"":"is-loading")},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-file-pdf"})),l.a.createElement("span",null,"T\xe9lecharger"))))))),l.a.createElement("hr",null))},p=a(8),f=a(9),E=a(11),b=a(7),N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.id=t.id||E.generate(),this.type=t.type||"Facture",this.types=["Facture","Devis"],this.items=t.items?Object(f.a)(t.items):[],this.meta=t.meta?Object(p.a)({},t.meta):{date:b().format(b.HTML5_FMT.DATE),dueDate:b().add(30,"days").format(b.HTML5_FMT.DATE),from:"",to:"",number:"",terms:""},this.options=t.options?Object(p.a)({},t.options):{detailed:!1,withTaxes:!1},this.locale=navigator.language}return Object(r.a)(e,null,[{key:"getSubTotals",value:function(e){var t=+e.quantity*+e.price,a=t*(+e.tax/100);return{subTotalTaxExcluded:t,subTotalTaxIncluded:t+a,subTotalTax:a}}},{key:"getTotals",value:function(t){var a=0,n=0,l=0;return t.length&&t.forEach(function(t){var s=e.getSubTotals(t);n+=s.subTotalTaxExcluded,a+=s.subTotalTaxIncluded,l+=s.subTotalTax}),{totalTaxExcluded:n,totalTaxIncluded:a,totalTaxes:l}}},{key:"firstLine",value:function(e){return e.split("\n")[0]}},{key:"afterFirstLine",value:function(e){return e.split("\n").slice(1).join("\n")}}]),e}();function y(e){return JSON.parse(JSON.stringify(e))}function g(e){var t=0;return Object.keys(e).forEach(function(e){return t++}),!Boolean(t)}function w(e,t,a){var n=y(e),l=Object.keys(n).map(function(e){return n[e]}),s={};return l.sort(function(e,n){var l=0,s=0;switch(t){case"number":l=e.meta.number.toString().replace(/\D/g,""),s=n.meta.number.toString().replace(/\D/g,"");break;case"date":l=b(e.meta.date,b.HTML5_FMT.DATE).valueOf(),s=b(n.meta.date,b.HTML5_FMT.DATE).valueOf();break;case"total":l=N.getTotals(e.items).totalTaxIncluded,s=N.getTotals(n.items).totalTaxIncluded}return"desc"===a?s-l:"asc"===a?l-s:0}),l.forEach(function(e){s[e.id]=e}),s}var T=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).embedPdf=function(){var e=y(a.props.invoice);Boolean(e.meta.date)&&(e.meta.date=new Date(e.meta.date).toLocaleDateString()),Boolean(e.meta.dueDate)&&(e.meta.dueDate=new Date(e.meta.dueDate).toLocaleDateString()),v.post("/api/html2pdf",{data:e},{headers:{"Content-Type":"application/json",Accept:"application/pdf"},responseType:"blob"}).then(function(t){var n="".concat(e.type,"-").concat(e.meta.number,".pdf"),l=new Blob([t.data],{type:"application/pdf"}),s=window.URL.createObjectURL(l);a.setState({filename:n,objectUrl:s})}).catch(function(e){console.log(e)})},a.state={filename:null,objectUrl:null},a}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.scrollTo(0,0),this.state.filename||this.embedPdf()}},{key:"render",value:function(){return l.a.createElement("div",{className:"container"},l.a.createElement(h,{closePreview:this.props.closePreview,filename:this.state.filename,objectUrl:this.state.objectUrl}),l.a.createElement("div",{className:"columns is-multiline"},this.state.filename&&l.a.createElement("object",{id:"mediaObject",data:this.state.objectUrl,type:"application/pdf",name:this.state.filename},"alt: ",l.a.createElement("a",{href:this.state.objectUrl,download:this.state.filename},this.state.filename))))}}]),t}(n.Component),x=a(12),I=(a(64),function(e){var t=e.name,a=e.id,n=e.value,s=e.changeHandler,i=Object(x.a)(e,["name","id","value","changeHandler"]);return l.a.createElement("div",{className:"control"},l.a.createElement("input",Object.assign({id:a,name:t,type:"text",className:"input",onChange:s||function(e){},value:n},i)))}),O=function(e){var t=e.name,a=e.id,n=e.value,s=e.changeHandler,i=Object(x.a)(e,["name","id","value","changeHandler"]);return l.a.createElement("div",{className:"control"},l.a.createElement("textarea",Object.assign({className:"textarea",name:t,id:a,onChange:s||function(e){},value:n},i)))},C=function(e){var t=e.name,a=e.value,n=e.changeHandler,s=e.tabs,i=Object(x.a)(e,["name","value","changeHandler","tabs"]);return l.a.createElement("div",{className:"select is-fullwidth"},l.a.createElement("select",Object.assign({name:t,value:a,onChange:n},i),s.map(function(e,t){return l.a.createElement("option",{key:"options-".concat(t),value:e.value},e.label)})))},j=function(e){var t=e.target,a=e.label,n=e.icon;return l.a.createElement("label",{htmlFor:t,className:"label"},l.a.createElement("span",{className:"icon is-small has-text-info"},l.a.createElement("i",{className:"fas fa-".concat(n)})),l.a.createElement("span",null," ".concat(a)))},k=function(e){var t=e.name,a=e.label;return l.a.createElement("div",{className:"file has-name is-fullwidth"},l.a.createElement("label",{className:"file-label"},l.a.createElement("input",{className:"file-input",type:"file",name:t}),l.a.createElement("span",{className:"file-cta"},l.a.createElement("span",{className:"file-icon"},l.a.createElement("i",{className:"fas fa-upload"})),l.a.createElement("span",{className:"file-label"},a)),l.a.createElement("span",{className:"file-name"})))},H=function(e){var t=e.options,a=e.optionsChangeHandler,n=e.types,s=e.type,i=e.typeChangeHandler;return l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"},l.a.createElement("div",{className:"level-item"},l.a.createElement("div",{className:"field is-horizontal"},l.a.createElement("div",{className:"field-label is-normal"},l.a.createElement("label",{className:"label"},"Formulaire")),l.a.createElement("div",{className:"field-body"},l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(C,{name:"input-type",value:s,changeHandler:i,tabs:n.map(function(e){return{value:e,label:e}})}))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(C,{name:"input-detailed",value:t.detailed,changeHandler:a,tabs:[{value:"false",label:"Simple"},{value:"true",label:"D\xe9taill\xe9"}]}))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(C,{name:"input-withTaxes",value:t.withTaxes,changeHandler:a,tabs:[{value:"false",label:"Sans Taxes"},{value:"true",label:"Avec Taxes"}]}))))))),l.a.createElement("div",{className:"level-right"}))},S=function(e){var t=e.from,a=e.to,n=e.number,s=e.date,i=e.dueDate,c=e.changeHandler,r=e.type;return l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"field"},l.a.createElement(j,{target:"input-from",label:"De",icon:"home"}),l.a.createElement(O,{name:"input-from",id:"input-from",changeHandler:c,value:t}))),l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"field"},l.a.createElement(j,{target:"",label:"Logo",icon:"image"}),l.a.createElement(k,{name:"file-input",label:"Ajouter une image"}))),l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"field"},l.a.createElement(j,{target:"input-to",label:"Factur\xe9 \xe0",icon:"handshake"}),l.a.createElement(O,{style:{paddingBottom:0},name:"input-to",id:"input-to",changeHandler:c,value:a,rows:"8"}))),l.a.createElement("div",{className:"column is-6"},l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"field"},l.a.createElement(j,{target:"input-number",label:"".concat(r," n\xb0"),icon:"search"}),l.a.createElement(I,{name:"input-number",id:"input-number",changeHandler:c,value:n}))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"field"},l.a.createElement(j,{target:"input-date",label:"Date",icon:"calendar-day"}),l.a.createElement(I,{type:"date",name:"input-date",id:"input-date",changeHandler:c,value:s}))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"field"},l.a.createElement(j,{target:"input-dueDate",label:"Ech\xe9ance",icon:"calendar-day"}),l.a.createElement(I,{type:"date",name:"input-dueDate",id:"input-dueDate",changeHandler:c,value:i}))))))},D=function(e){var t=e.detailed,a=e.withTaxes,n=[{detailedOnly:!0,withTaxesOnly:!1,label:"Qt\xe9",icon:"sort-amount-up",size:1},{detailedOnly:!1,withTaxesOnly:!1,label:"D\xe9signation",icon:"tag",size:t?4:6},{detailedOnly:!1,withTaxesOnly:!1,label:"Prix".concat(t?" Unit.":"").concat(a?" HT":""),icon:"euro-sign",size:2},{detailedOnly:!0,withTaxesOnly:!1,label:"Montant".concat(a?" HT":""),icon:"euro-sign",size:2},{detailedOnly:!1,withTaxesOnly:!0,label:"TVA",icon:"percentage",size:t?2:3}].filter(function(e){return(!e.detailedOnly||e.detailedOnly&&t)&&(!e.withTaxesOnly||e.withTaxesOnly&&a)});return l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"columns"},n.map(function(e,t){return l.a.createElement("div",{className:"column is-".concat(e.size),key:"item-heading-".concat(t)},l.a.createElement(j,{icon:e.icon,label:e.label}))})))},F=function(e){var t=e.detailed,a=e.withTax,n=e.data,s=e.changeHandler,i=e.blurHandler;return l.a.createElement("div",{className:"column is-12 animated fadeIn fast"},l.a.createElement("div",{className:"columns"},t&&l.a.createElement("div",{className:"column is-1"},l.a.createElement(I,{"data-id":"".concat(n.id),"data-field":"quantity",value:n.quantity,changeHandler:function(e){s(e,"update")},onBlur:i})),l.a.createElement("div",{className:"column is-".concat(t?"4":"6")},l.a.createElement(O,{"data-id":"".concat(n.id),"data-field":"title",value:n.title,changeHandler:function(e){s(e,"update")},onBlur:i})),l.a.createElement("div",{className:"column is-2"},l.a.createElement(I,{"data-id":"".concat(n.id),"data-field":"price",value:n.price,changeHandler:function(e){s(e,"update")},onBlur:i})),t&&l.a.createElement("div",{className:"column is-2"},l.a.createElement(I,{disabled:!0,value:(n.quantity*n.price).toFixed(2),changeHandler:function(e){}})),a&&l.a.createElement("div",{className:"column is-2"},l.a.createElement(I,{"data-id":"".concat(n.id),"data-field":"tax",value:n.tax,changeHandler:function(e){s(e,"update")},onBlur:i})),l.a.createElement("div",{className:"column is-1"},l.a.createElement("button",{"data-id":"".concat(n.id),onClick:function(e){return s(e,"remove")},className:"button is-danger is-fullwidth"},l.a.createElement("span",{"data-id":"".concat(n.id),className:"icon"},l.a.createElement("i",{"data-id":"".concat(n.id),className:"fas fa-times"}))))))},B=function(e){var t=e.detailed,a=e.withTaxes,n=e.changeHandler,s=e.blurHandler,i=e.items;return l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement(D,{detailed:t,withTaxes:a}),i.map(function(e){return l.a.createElement(F,{key:e.id,data:e,changeHandler:n,detailed:t,withTax:a,blurHandler:s})}),l.a.createElement("div",{className:"column is-12"},l.a.createElement("button",{onClick:function(e){return n(e,"add")},className:"button is-link is-fullwidth"},l.a.createElement("span",{className:"icon"},l.a.createElement("i",{className:"fas fa-plus"})),l.a.createElement("span",null,"Ajouter un article"))))},L=function(e){var t=e.label,a=e.value,n=e.size,s=e.color;return l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"columns has-text-".concat(s)},l.a.createElement("div",{className:"column is-4"}),l.a.createElement("div",{className:"column is-4 has-text-right"},l.a.createElement("span",{className:"is-size-".concat(n)},t)),l.a.createElement("div",{className:"column is-4 has-text-right"},l.a.createElement("span",{className:"is-size-".concat(n)},a," \u20ac"))))},A=function(e){var t=e.withTax,a=e.items,n=N.getTotals(a),s=n.totalTaxExcluded,i=n.totalTaxIncluded,c=n.totalTaxes;return l.a.createElement("div",{className:"columns is-multiline"},t&&l.a.createElement(L,{label:"TOTAL HT",value:s.toFixed(2),size:"5",color:"grey-dark"}),t&&l.a.createElement(L,{label:"TVA",value:c.toFixed(2),size:"6",color:"grey"}),l.a.createElement(L,{label:"TOTAL".concat(t?" TTC":""),value:i.toFixed(2),size:"4",color:"black-ter"}))},P=function(e){var t=e.terms,a=e.changeHandler;return l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"field"},l.a.createElement(j,{target:"input-terms",icon:"building",label:"Conditions et modalit\xe9s de paiement"}),l.a.createElement(O,{name:"input-terms",id:"input-terms",value:t,changeHandler:a}))))},U=function(e){var t=e.leaveInvoice,a=e.openPreview,n=e.removeInvoice;return l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"},l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{onClick:t,className:"button is-dark"},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-arrow-left"})),l.a.createElement("span",null,"Retour"))),l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{onClick:a,className:"button is-info"},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-eye"})),l.a.createElement("span",null,"Aper\xe7u")))),l.a.createElement("div",{className:"level-right"},l.a.createElement("div",{className:"level-item"},l.a.createElement("button",{onClick:n,className:"button is-danger"},l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-trash-alt"})),l.a.createElement("span",null,"Supprimer")))))},W=function(){return l.a.createElement("div",{className:"columns no-print"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("hr",null)))},M=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null,title:"",price:0,tax:0,quantity:1};Object(c.a)(this,e),this.id=t.id||E.generate(),this.title=t.title,this.price=t.price,this.tax=t.tax,this.quantity=t.quantity},z=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).metaChangeHandler=function(e){var t=Object(p.a)({},a.state.meta);t[e.target.name.split("-")[1]]=e.target.value,a.setState({meta:t})},a.optionsChangeHandler=function(e){var t=Object(p.a)({},a.state.options),n=e.target.name.split("-")[1],l="true"===e.target.value;t[n]=l;var s=a.cloneItems(a.state.items);s.forEach(function(e){e.quantity=t.detailed?e.quantity:1,e.tax=t.withTaxes?e.tax:0}),a.setState({options:t,items:s})},a.typeChangeHandler=function(e){var t=e.target.value;a.state.types.includes(t)&&a.setState({type:t})},a.itemsChangeHandler=function(e,t){switch(t){case"add":a.addItem();break;case"update":var n=e.target.getAttribute("data-id"),l=e.target.getAttribute("data-field"),s=e.target.value;a.updateItem(n,l,s);break;case"remove":var i=e.target.getAttribute("data-id");a.removeItem(i)}},a.itemsBlurHandler=function(e){var t=e.target.getAttribute("data-id"),n=e.target.getAttribute("data-field"),l=e.target.value;switch(n){case"title":l=l.trim();break;case"quantity":case"tax":case"price":l=isNaN(l)?0:+(+l).toFixed(2)}a.updateItem(t,n,l)},a.addItem=function(){var e=a.cloneItems(a.state.items);e.push(new M),a.setState({items:a.cloneItems(e)})},a.updateItem=function(e,t,n){var l=a.cloneItems(a.state.items);l.find(function(t){return t.id===e})[t]=n,a.setState({items:a.cloneItems(l)})},a.removeItem=function(e){var t=a.cloneItems(a.state.items);t=t.filter(function(t){return t.id!==e}),a.setState({items:a.cloneItems(t)})},a.cloneItems=function(e){return e.map(function(e){return new M(e)})},a.state={id:null,type:"Facture",types:["Facture","Devis"],meta:{from:"",to:"",number:"",date:"",dueDate:"",terms:""},options:{detailed:!1,withTaxes:!1},items:[]},a.state=y(a.props.invoice),a}return Object(d.a)(t,e),Object(r.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.invoice.id!==this.state.id&&this.setState(Object(p.a)({},y(e.invoice)))}},{key:"shouldComponentUpdate",value:function(e,t){return JSON.stringify(t)!==JSON.stringify(this.state)}},{key:"componentDidUpdate",value:function(e,t){this.props.updateHandler(y(this.state))}},{key:"componentDidMount",value:function(){window.scroll(0,0)}},{key:"render",value:function(){return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box animated slideInDown"},l.a.createElement(H,{type:this.state.type,types:this.state.types,options:this.state.options,optionsChangeHandler:this.optionsChangeHandler,typeChangeHandler:this.typeChangeHandler}))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box animated fadeIn"},l.a.createElement(S,{companyTitle:this.state.companyTitle,type:this.state.type,from:this.state.meta.from,to:this.state.meta.to,number:this.state.meta.number,date:this.state.meta.date,dueDate:this.state.meta.dueDate,changeHandler:this.metaChangeHandler}),l.a.createElement(W,null),l.a.createElement(B,{detailed:this.state.options.detailed,withTaxes:this.state.options.withTaxes,changeHandler:this.itemsChangeHandler,blurHandler:this.itemsBlurHandler,items:this.state.items}),l.a.createElement(A,{withTax:this.state.options.withTaxes,items:this.state.items}),l.a.createElement(W,null),l.a.createElement(P,{terms:this.state.meta.terms,changeHandler:this.metaChangeHandler}))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box"},l.a.createElement(U,{leaveInvoice:this.props.leaveInvoice,openPreview:this.props.openPreview,removeInvoice:this.props.removeInvoice})))))}}]),t}(n.Component),q=function(e){var t=e.setNewInvoiceType,a=e.invoiceTypes,n=e.newInvoice,s=e.typeSelected;return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"}),l.a.createElement("div",{className:"level-right"},l.a.createElement("div",{className:"level-item"},l.a.createElement("div",{className:"field has-addons"},l.a.createElement("div",{className:"control"},l.a.createElement("button",{className:"button is-static"},"Nouveau")),l.a.createElement("div",{className:"control is-expanded"},l.a.createElement(C,{onChange:t,defaultValue:"",name:"newInvoiceType",tabs:a.map(function(e){return{value:e,label:e}}).concat({value:"",label:"Document"})})),l.a.createElement("div",{className:"control"},l.a.createElement("button",Object.assign({},s?{}:{disabled:!0},{onClick:n,className:"button is-primary ".concat(s?" animated pulse fast":"")}),l.a.createElement("span",{className:"icon is-small"},l.a.createElement("i",{className:"fas fa-plus"})))))))))),l.a.createElement(W,null))},J=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).sort=function(e){var t=e.target.getAttribute("data-sortby");if(t&&a.possibleSorts.includes(t)){var n=null;n=a.state.sortBy===t&&"desc"===a.state.sortOrder?"asc":"desc";var l=w(a.state.invoices,t,n);a.setState({sortBy:t,sortOrder:n,invoices:l})}},a.setFilter=function(e){var t=e.target.value;a.setState({filterBy:t})},a.search=function(e){var t=e.target.value,n=y(a.props.invoices),l=Object.keys(n).map(function(e){return n[e]}),s={};l.forEach(function(e){var a=e.meta.to.toLowerCase().includes(t.toLowerCase()),n=new Date(e.meta.date).toLocaleDateString().includes(t),l="".concat(e.meta.number).includes(t),i=N.getTotals(e.items).totalTaxIncluded.toFixed(2).includes(t);(a||n||l||i)&&(s[e.id]=e)}),a.setState({searchTerm:t,invoices:w(s,a.state.sortBy,a.state.sortOrder)},function(){a.fixCellWidths()})},a.formatClientName=function(e){return e.slice(0,20)},a.fixCellWidths=function(){Object.keys(a.minCellWidths).forEach(function(e){Object(f.a)(document.getElementsByClassName(e)).forEach(function(t){var n=t.clientWidth;a.minCellWidths[e]<n&&(a.minCellWidths[e]=n)})}),Object.keys(a.minCellWidths).forEach(function(e){Object(f.a)(document.getElementsByClassName(e)).forEach(function(t){t.style.minWidth=a.minCellWidths[e]+"px"})})},a.state={invoices:w(a.props.invoices,"date","desc"),sortBy:"date",sortOrder:"desc",filterBy:"",searchTerm:""},a.minCellWidths={clientCell:0,typeCell:0,numberCell:0,dateCell:0,totalCell:0},a.possibleSorts=["number","date","total"],a.filters=(new N).types,a}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.fixCellWidths()}},{key:"render",value:function(){var e=this,t=this.state.invoices,a=this.state.sortBy,n=this.state.sortOrder,s=this.state.filterBy,i=this.state.searchTerm,c={cursor:"pointer",userSelect:"none"};return l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"level"},l.a.createElement("div",{className:"level-left"},l.a.createElement("div",{className:"level-item"},l.a.createElement("div",{className:"field has-addons"},l.a.createElement("div",{className:"control"},l.a.createElement("button",{className:"button is-static"},"Recherche")),l.a.createElement("div",{className:"control has-icons-right"},l.a.createElement("input",{className:"input",type:"text",value:i,onChange:this.search,placeholder:"par client, adresse, num\xe9ro, etc..."}),l.a.createElement("span",{className:"icon is-small is-right"},l.a.createElement("i",{className:"fas fa-search"})))))))),l.a.createElement("div",{className:"column is-12"},l.a.createElement("div",{className:"box"},l.a.createElement("div",{className:"table-container"},l.a.createElement("table",{className:"table is-striped is-hoverable is-fullwidth"},l.a.createElement("thead",{onClick:this.sort},l.a.createElement("tr",null,l.a.createElement("th",{className:"has-text-centered"},l.a.createElement("span",null,"Client")),l.a.createElement("th",{style:{paddingTop:"0"}},l.a.createElement("div",{className:"field has-addons"},l.a.createElement("div",{className:"control"},l.a.createElement("button",{className:"button is-static"},"Type")),l.a.createElement("div",{className:"control"},l.a.createElement(C,{value:this.state.filterBy,onChange:this.setFilter,tabs:this.filters.map(function(e){return{label:e,value:e}}).concat({value:"",label:"Tout"})})))),l.a.createElement("th",{"data-sortby":"number",style:c},l.a.createElement("span",{className:"number"===a?"has-text-link":"","data-sortby":"number"},"Nombre")," ",l.a.createElement("span",{"data-sortby":"number",className:"icon is-small has-text-info"},"number"===a&&l.a.createElement("i",{"data-sortby":"number",className:"fas fa-sort-numeric-".concat("desc"===n?"down":"up")}))),l.a.createElement("th",{"data-sortby":"date",style:c},l.a.createElement("span",{"data-sortby":"date",className:"date"===a?"has-text-link":""},"Date")," ",l.a.createElement("span",{"data-sortby":"date",className:"icon is-small has-text-info"},"date"===a&&l.a.createElement("i",{"data-sortby":"date",className:"fas fa-sort-numeric-".concat("desc"===n?"down":"up")}))),l.a.createElement("th",{"data-sortby":"total",style:c},l.a.createElement("span",{"data-sortby":"total",className:"total"===a?"has-text-link":""},"Montant")," ",l.a.createElement("span",{"data-sortby":"total",className:"icon is-small has-text-info"},"total"===a&&l.a.createElement("i",{"data-sortby":"total",className:"fas fa-sort-amount-".concat("desc"===n?"down":"up")}))))),l.a.createElement("tbody",null,Object.keys(t).map(function(a){var n=t[a];return l.a.createElement("tr",{className:Boolean(s)&&n.type!==s?"is-hidden":"",style:{cursor:"pointer"},onClick:e.props.selectInvoice,"data-id":a,key:a},l.a.createElement("td",{"data-id":a,className:"clientCell"},e.formatClientName(N.firstLine(n.meta.to))),l.a.createElement("td",{"data-id":a,className:"has-text-centered typeCell"},n.type),l.a.createElement("td",{className:"numberCell","data-id":a},n.meta.number),l.a.createElement("td",{className:"dateCell","data-id":a},new Date(n.meta.date).toLocaleDateString()),l.a.createElement("td",{className:"totalCell","data-id":a},N.getTotals(n.items).totalTaxIncluded.toFixed(2)," \u20ac"))}))))))))}}]),t}(n.Component),R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).updateInvoice=function(e){var t=e.id,n=y(a.state.invoices);n[t]=y(e),a.currentInvoiceWasUpdated=!0,a.setState({invoices:n,currentInvoice:y(e)})},a.newInvoice=function(){var e=new N;a.state.newInvoiceType&&(e.type=a.state.newInvoiceType);var t=function(e){var t={};return Object.keys(e).forEach(function(a){var n=e[a].type;n in t?t[n]++:t[n]=1}),t}(a.state.invoices)[e.type]||0;e.meta.number=t+1,a.setState({currentInvoice:e,showForm:!0})},a.setNewInvoiceType=function(e){var t=e.target.value;Boolean(t)&&a.invoiceTypes.includes(t)?a.setState({newInvoiceType:t}):a.setState({newInvoiceType:null})},a.selectInvoice=function(e){var t=e.target.getAttribute("data-id"),n=a.state.invoices[t];n&&a.setState({currentInvoice:y(n),showForm:!0})},a.removeInvoice=function(){var e=a.state.currentInvoice.id,t=y(a.state.invoices);delete t[e],a.setState({invoices:t,currentInvoice:null,newInvoiceType:null,showForm:!1},function(){a.updateLocalForage()})},a.leaveInvoice=function(){a.saveChanges(),a.setState({currentInvoice:null,newInvoiceType:null,showForm:!1})},a.openPreview=function(){a.saveChanges(),a.setState({showPreview:!0})},a.hidePreview=function(){a.setState({showPreview:!1})},a.updateLocalForage=function(){u.setItem("invoices",y(a.state.invoices)).then(function(e){console.log("LocalForage Updated")}).catch(function(e){console.log("Unable to update localForage\n"),console.error(e)})},a.loadFromLocalForage=function(){return u.getItem("invoices")},a.saveChanges=function(){if(a.currentInvoiceWasUpdated){var e=y(a.state.currentInvoice);console.log(e),a.updateLocalForage(),a.currentInvoiceWasUpdated=!1}},a.state={showPreview:!1,showForm:!1,currentInvoice:null,invoices:{},newInvoiceType:null},a.currentInvoiceWasUpdated=!1,a.invoiceTypes=(new N).types,a}return Object(d.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;g(this.state.invoices)&&this.loadFromLocalForage().then(function(t){t&&"object"===typeof t&&!g(t)&&e.setState({invoices:y(t)})}).catch(function(e){console.error(e)})}},{key:"render",value:function(){return l.a.createElement("section",null,this.state.showPreview&&l.a.createElement(T,{closePreview:this.hidePreview,invoice:this.state.currentInvoice}),!this.state.showPreview&&l.a.createElement("div",{id:"main"},!this.state.showForm&&l.a.createElement(q,{typeSelected:Boolean(this.state.newInvoiceType),invoiceTypes:this.invoiceTypes,setNewInvoiceType:this.setNewInvoiceType,newInvoice:this.newInvoice}),!g(this.state.invoices)&&!this.state.showForm&&l.a.createElement(J,{invoices:this.state.invoices,selectInvoice:this.selectInvoice}),this.state.showForm&&l.a.createElement(z,{key:this.state.currentInvoice.id,updateHandler:this.updateInvoice,invoice:this.state.currentInvoice,leaveInvoice:this.leaveInvoice,openPreview:this.openPreview,removeInvoice:this.removeInvoice})))}}]),t}(n.Component),_=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"section"},l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"columns is-multiline"},l.a.createElement("div",{className:"column is-12"},l.a.createElement(R,null)))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[24,2,1]]]);
//# sourceMappingURL=main.31ed5618.chunk.js.map